package game;

import java.util.Arrays;
import java.util.List;

import edu.monash.fit2099.engine.displays.Display;
import edu.monash.fit2099.engine.positions.FancyGroundFactory;
import edu.monash.fit2099.engine.positions.GameMap;
import edu.monash.fit2099.engine.positions.World;
import game.enemies.*;
import game.environments.*;
import game.items.GoldenRune;
import game.items.GoldenSeed;
import game.items.PreservingBolus;
import game.items.SacredTear;
import game.npcs.NpcManager;
import game.combatclasses.CombatClass;
import game.resettables.ResetManager;
import game.utils.FancyMessage;
import game.utils.CombatClassMenu;

/**
 * The main class to start the game.
 * Created by:
 * @author Adrian Kristanto
 * Modified by:
 *
 */
public class Application {

	public static void main(String[] args) {

		Display display = new Display();
		World world = new World(display);

		FancyGroundFactory groundFactory = new FancyGroundFactory(new RotPuddle(), new Cage(), new Barracks(), new SummonSign(), new Cliff(), new Dirt(), new Wall(), new Floor(), new Graveyard(), new GustOfWind(), new PuddleOfWater());

		///////////////////////////////////////////////////////////
		// ADDING LIMGRAVE										//
		/////////////////////////////////////////////////////////

		List<String> limgraveString = Arrays.asList(
				"......................#.............#..........................+++.........",
				"......................#.............#.......................+++++..........",
				"......................#..___....____#.........................+++++........",
				"......................#...........__#............................++........",
				"......................#_____........#.............................+++......",
				"......................#............_#..............................+++.....",
				"......................######...######......................................",
				"...........................................................................",
				"......................................=....................................",
				"........++++......................###___###................................",
				"........+++++++...................________#................................",
				"..........+++.....................#________................................",
				"............+++...................#_______#................................",
				".............+....................###___###................................",
				"............++......................#___#..................................",
				"..............+...................=........................................",
				"..............++.................................................=.........",
				"..............................................++...........................",
				"..................++++......................+++...............######..##...",
				"#####___######....++...........................+++............#....____....",
				"_____________#.....++++..........................+..............__.....#...",
				"_____________#.....+....++........................++.........._.....__.#...",
				"_____________#.........+..+.....................+++...........###..__###...",
				"_____________#.............++..............................................");

		GameMap limgrave = new GameMap(groundFactory, limgraveString);
		world.addGameMap(limgrave);

		///////////////////////////////////////////////////////////////////
		// ADDING STORMVEIL CASTLE										//
		/////////////////////////////////////////////////////////////////

		List<String> stormveilString = Arrays.asList(
				"...........................................................................",
				"..................<...............<........................................",
				"...........................................................................",
				"##############################################...##########################",
				"............................#................#.......B..............B......",
				".....B...............B......#................#.............................",
				"...............................<.........<.................................",
				".....B...............B......#................#.......B..............B......",
				"............................#................#.............................",
				"#####################..#############...############.####..#########...#####",
				"...............#++++++++++++#................#++++++++++++#................",
				"...............#++++++++++++...<.........<...#++++++++++++#................",
				"...............#++++++++++++..................++++++++++++#................",
				"...............#++++++++++++#................#++++++++++++#................",
				"#####...##########.....#############...#############..#############...#####",
				".._______........................B......B........................B.....B...",
				"_____..._..____....&&........<..............<..............................",
				".........____......&&......................................................",
				"...._______..................<..............<....................<.....<...",
				"#####....##...###..#####...##########___###############......##.....####...",
				"+++++++++++++++++++++++++++#...................#+++++++++++++++++++++++++++",
				"+++++++++++++++++++++++++++....................#+++++++++++++++++++++++++++",
				"+++++++++++++++++++++++++++#....................+++++++++++++++++++++++++++",
				"+++++++++++++++++++++++++++#...................#+++++++++++++++++++++++++++");

		GameMap stormveil = new GameMap(groundFactory, stormveilString);
		world.addGameMap(stormveil);

		///////////////////////////////////////////////////////////////////
		// ADDING ROUNDTABLE HOLD										//
		/////////////////////////////////////////////////////////////////

		List<String> roundtableString = Arrays.asList(
				"##################",
				"#________________#",
				"#________________#",
				"#________________#",
				"#________________#",
				"#________________#",
				"#________________#",
				"#________________#",
				"#________________#",
				"#________________#",
				"########___#######");

		GameMap roundtable = new GameMap(groundFactory, roundtableString);
		world.addGameMap(roundtable);

		///////////////////////////////////////////////////////////
		// ADDING LAKE OF ROT									//
		/////////////////////////////////////////////////////////

		List<String> lakeOfRotString = Arrays.asList(
				"...............................................................+++.........",
				"............................................................+++++..........",
				"..............................................................+++++........",
				".................................................................++........",
				"....................../////////////////////////...................+++......",
				".............................////////////////////////..............+++.....",
				"......................../////////////////////////////......................",
				"...................////////////////////////////////////////................",
				".....................////////////////////////////////......................",
				"........................////////////////////////////////////...............",
				"...................///////////////////////////////////////.................",
				"....................///////////////////////////////........................",
				"........................./////////////////////////.........................",
				".................//////////////////////////////////////....................",
				"...................../////////////////////////////////.....................",
				"....................////////////////////////////////////////////...........",
				"........................///////////////////////////////....................",
				"...................../////////////////////////////////////.................",
				"..................//////////////////////////////////////////////////.......",
				"#####___######.............................................................",
				"_____________#.............................................................",
				"_____________#.............................................................",
				"_____________#.............................................................",
				"_____________#.............................................................");

		GameMap lakeOfRot = new GameMap(groundFactory, lakeOfRotString);
		world.addGameMap(lakeOfRot);

		///////////////////////////////////////////////////////////////////
		// ADDING BOSS ROOM 											//
		/////////////////////////////////////////////////////////////////

		List<String> bossRoomString = Arrays.asList(
				"+++++++++++++++++++++++++",
				".........................",
				"..=......................",
				".........................",
				".........................",
				".........................",
				".........................",
				".........................",
				"+++++++++++++++++++++++++");

		GameMap bossRoom = new GameMap(groundFactory, bossRoomString);
		world.addGameMap(bossRoom);

		// limgrave stuff
		limgrave.at(38, 11).setGround(new SiteOfLostGrace("The First Step"));
		limgrave.at(39,11).addActor(NpcManager.generateMerchantKale());
		limgrave.at(39, 10).setGround(new GoldenFogDoor("Roundtable Hold", roundtable.at(9,5)));
		limgrave.at(37, 10).setGround(new GoldenFogDoor("Stormveil Castle", stormveil.at(0,0)));
		limgrave.at(38, 9).setGround(new GoldenFogDoor("Lake of Rot", lakeOfRot.at(20,9)));
		limgrave.at(37, 11).addActor(NpcManager.generateFingerReaderEnia());

		//stormveil stuff
		stormveil.at(1,0).setGround(new GoldenFogDoor("Limgrave", limgrave.at(38,10)));
		stormveil.at(0,1).setGround(new GoldenFogDoor("Boss Room", bossRoom.at(1,2)));

		// roundtable stuff
		roundtable.at(8,4).setGround(new GoldenFogDoor("Limgrave", limgrave.at(38,10)));

		// boss room stuff
		bossRoom.addActor(EnemyFactory.createGodrickTheGrafted(bossRoom), bossRoom.at(24, 7));

		// lake of rot stuff
		lakeOfRot.at(19,9).setGround(new GoldenFogDoor("Limgrave", limgrave.at(38,10)));

		for (String line : FancyMessage.ELDEN_RING.split("\n")) {
			new Display().println(line);
			try {
				Thread.sleep(200);
			} catch (Exception exception) {
				exception.printStackTrace();
			}
		}

		CombatClass combatClass = CombatClassMenu.promptClass();
		Player player = new Player("Tarnished", '@', combatClass, limgrave);
		player.addItemToInventory(new SacredTear());
		player.addItemToInventory(new GoldenSeed());
		player.addItemToInventory(new GoldenRune());
		player.addItemToInventory(new PreservingBolus());
		ResetManager.getInstance().registerResettable(player);
		world.addPlayer(player, limgrave.at(38, 10));
		ResetManager.setPlayerSpawnPoint(limgrave.at(38, 10));
		world.run();
	}
}
